#!/bin/bash
#SBATCH --job-name=vae-ddp
#SBATCH --nodes=2
#SBATCH --ntasks-per-node=4  # Adjust to your GPUs per node
#SBATCH --gpus-per-node=4
#SBATCH --cpus-per-task=4
#SBATCH --mem=32G
#SBATCH --time=01:00:00
#SBATCH --output=logs/%x_%j.out

export MASTER_ADDR=$(scontrol show hostnames $SLURM_JOB_NODELIST | head -n 1)
export MASTER_PORT=12355
export WORLD_SIZE=$SLURM_NTASKS

srun python train_ddp.py