Sat Jun 21 20:41:26 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 530.30.02              Driver Version: 530.30.02    CUDA Version: 12.1     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                  Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf            Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM-64GB            On | 00000000:1D:00.0 Off |                    0 |
| N/A   42C    P0               60W / 457W|      0MiB / 65536MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM-64GB            On | 00000000:56:00.0 Off |                    0 |
| N/A   43C    P0               59W / 456W|      0MiB / 65536MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM-64GB            On | 00000000:8F:00.0 Off |                    0 |
| N/A   43C    P0               62W / 456W|      0MiB / 65536MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM-64GB            On | 00000000:C8:00.0 Off |                    0 |
| N/A   42C    P0               61W / 458W|      0MiB / 65536MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
+ -------------- SLURM CHECK -------------- +
CUDA_VISIBLE_DEVICES=0,1,2,3
NODES=4
+ ----------------------------------------- +
+ ---------- TORCH LIBRARY CHECK ---------- +
PyTorch version: 2.7.1+cu126
PyTorch CUDA version: 12.6
PyTorch CUDNN version: 90501
GPUs per node 4
[Rank 8] GPU_RANK=0 on CUDA device 0 hostname=lrdn0184.leonardo.local
Training with GPUs :)
+ ----------------------------------------- +
[Rank 0] GPU_RANK=0 on CUDA device 0 hostname=lrdn0059.leonardo.local
[Rank 1] GPU_RANK=1 on CUDA device 1 hostname=lrdn0059.leonardo.local
[Rank 4] GPU_RANK=0 on CUDA device 0 hostname=lrdn0155.leonardo.local
[Rank 2] GPU_RANK=2 on CUDA device 2 hostname=lrdn0059.leonardo.local
[Rank 3] GPU_RANK=3 on CUDA device 3 hostname=lrdn0059.leonardo.local
[Rank 12] GPU_RANK=0 on CUDA device 0 hostname=lrdn0236.leonardo.local
[Rank 5] GPU_RANK=1 on CUDA device 1 hostname=lrdn0155.leonardo.local
[Rank 9] GPU_RANK=1 on CUDA device 1 hostname=lrdn0184.leonardo.local
[Rank 6] GPU_RANK=2 on CUDA device 2 hostname=lrdn0155.leonardo.local
[Rank 10] GPU_RANK=2 on CUDA device 2 hostname=lrdn0184.leonardo.local
[Rank 7] GPU_RANK=3 on CUDA device 3 hostname=lrdn0155.leonardo.local
[Rank 11] GPU_RANK=3 on CUDA device 3 hostname=lrdn0184.leonardo.local
[Rank 13] GPU_RANK=1 on CUDA device 1 hostname=lrdn0236.leonardo.local
[Rank 14] GPU_RANK=2 on CUDA device 2 hostname=lrdn0236.leonardo.local
[Rank 15] GPU_RANK=3 on CUDA device 3 hostname=lrdn0236.leonardo.local
[RANK 14] I have 3750 samples. From 52500 to 56250
[RANK 4] I have 3750 samples. From 15000 to 18750
[RANK 10] I have 3750 samples. From 37500 to 41250
[RANK 13] I have 3750 samples. From 48750 to 52500
[RANK 12] I have 3750 samples. From 45000 to 48750
[RANK 9] I have 3750 samples. From 33750 to 37500
[RANK 11] I have 3750 samples. From 41250 to 45000
[RANK 5] I have 3750 samples. From 18750 to 22500
[RANK 15] I have 3750 samples. From 56250 to 60000
[RANK 1] I have 3750 samples. From 3750 to 7500
[RANK 7] I have 3750 samples. From 26250 to 30000
[RANK 6] I have 3750 samples. From 22500 to 26250
[RANK 2] I have 3750 samples. From 7500 to 11250
[RANK 8] I have 3750 samples. From 30000 to 33750
[RANK 3] I have 3750 samples. From 11250 to 15000
[RANK 0] This dataset has 60000 samples
[RANK 0] I have 3750 samples. From 0 to 3750
[RANK 0] Trainer is running...
[RANK 0 GPU 0] Epoch 0 | Steps: 157
  0   |    0    |   0.1138   |   0.1148    |    1.56   
[RANK 11 GPU 3] Epoch 0 | Steps: 157
 11   |    0    |   0.1148   |   0.1148    |    2.71   
[RANK 2 GPU 2] Epoch 0 | Steps: 157
  2   |    0    |   0.1148   |   0.1148    |    2.71   
[RANK 8 GPU 0] Epoch 0 | Steps: 157
  8   |    0    |   0.1137   |   0.1148    |    1.57   
[RANK 3 GPU 3] Epoch 0 | Steps: 157
  3   |    0    |   0.1172   |   0.1148    |    2.71   
[RANK 9 GPU 1] Epoch 0 | Steps: 157
  9   |    0    |   0.1137   |   0.1148    |    2.71   
[RANK 1 GPU 1] Epoch 0 | Steps: 157
  1   |    0    |   0.1164   |   0.1148    |    2.71   
[RANK 4 GPU 0] Epoch 0 | Steps: 157
  4   |    0    |   0.1134   |   0.1148    |    1.58   
[RANK 10 GPU 2] Epoch 0 | Steps: 157
 10   |    0    |   0.1148   |   0.1148    |    2.71   
[RANK 5 GPU 1] Epoch 0 | Steps: 157
  5   |    0    |   0.1159   |   0.1148    |    2.71   
[RANK 12 GPU 0] Epoch 0 | Steps: 157
 12   |    0    |   0.1164   |   0.1148    |    1.56   
[RANK 6 GPU 2] Epoch 0 | Steps: 157
  6   |    0    |   0.1155   |   0.1148    |    2.71   
[RANK 7 GPU 3] Epoch 0 | Steps: 157
  7   |    0    |   0.1156   |   0.1148    |    2.71   
[RANK 13 GPU 1] Epoch 0 | Steps: 157
 13   |    0    |   0.1137   |   0.1148    |    2.71   
[RANK 14 GPU 2] Epoch 0 | Steps: 157
 14   |    0    |   0.1136   |   0.1148    |    2.71   
[RANK 15 GPU 3] Epoch 0 | Steps: 157
 15   |    0    |   0.1129   |   0.1148    |    2.71   
[RANK 0 GPU 0] Epoch 1 | Steps: 157
  0   |    1    |   0.0693   |   0.0695    |    0.60   
[RANK 1 GPU 1] Epoch 1 | Steps: 157
  1   |    1    |   0.0701   |   0.0695    |    0.60   
[RANK 4 GPU 0] Epoch 1 | Steps: 157
  4   |    1    |   0.0671   |   0.0695    |    0.60   
[RANK 8 GPU 0] Epoch 1 | Steps: 157
  8   |    1    |   0.0682   |   0.0695    |    0.60   
[RANK 12 GPU 0] Epoch 1 | Steps: 157
 12   |    1    |   0.0705   |   0.0695    |    0.60   
[RANK 2 GPU 2] Epoch 1 | Steps: 157
  2   |    1    |   0.0708   |   0.0695    |    0.60   
[RANK 5 GPU 1] Epoch 1 | Steps: 157
  5   |    1    |   0.0711   |   0.0695    |    0.60   
[RANK 9 GPU 1] Epoch 1 | Steps: 157
  9   |    1    |   0.0699   |   0.0695    |    0.60   
[RANK 13 GPU 1] Epoch 1 | Steps: 157
 13   |    1    |   0.0687   |   0.0695    |    0.60   
[RANK 3 GPU 3] Epoch 1 | Steps: 157
  3   |    1    |   0.0717   |   0.0695    |    0.60   
[RANK 6 GPU 2] Epoch 1 | Steps: 157
  6   |    1    |   0.0697   |   0.0695    |    0.60   
[RANK 10 GPU 2] Epoch 1 | Steps: 157
 10   |    1    |   0.0698   |   0.0695    |    0.60   
[RANK 14 GPU 2] Epoch 1 | Steps: 157
 14   |    1    |   0.0684   |   0.0695    |    0.60   
[RANK 7 GPU 3] Epoch 1 | Steps: 157
  7   |    1    |   0.0701   |   0.0695    |    0.60   
[RANK 11 GPU 3] Epoch 1 | Steps: 157
 11   |    1    |   0.0688   |   0.0695    |    0.60   
[RANK 15 GPU 3] Epoch 1 | Steps: 157
 15   |    1    |   0.0684   |   0.0695    |    0.60   
[RANK 0 GPU 0] Epoch 2 | Steps: 157
  0   |    2    |   0.0649   |   0.0655    |    0.64   
[RANK 8 GPU 0] Epoch 2 | Steps: 157
  8   |    2    |   0.0644   |   0.0655    |    0.64   
[RANK 1 GPU 1] Epoch 2 | Steps: 157
  1   |    2    |   0.0658   |   0.0655    |    0.64   
[RANK 4 GPU 0] Epoch 2 | Steps: 157
  4   |    2    |   0.0635   |   0.0655    |    0.64   
[RANK 9 GPU 1] Epoch 2 | Steps: 157
  9   |    2    |   0.0662   |   0.0655    |    0.64   
[RANK 2 GPU 2] Epoch 2 | Steps: 157
  2   |    2    |   0.0667   |   0.0655    |    0.64   
[RANK 10 GPU 2] Epoch 2 | Steps: 157
 10   |    2    |   0.0655   |   0.0655    |    0.64   
[RANK 3 GPU 3] Epoch 2 | Steps: 157
  3   |    2    |   0.0677   |   0.0655    |    0.64   
[RANK 11 GPU 3] Epoch 2 | Steps: 157
 11   |    2    |   0.0649   |   0.0655    |    0.64   
[RANK 12 GPU 0] Epoch 2 | Steps: 157
 12   |    2    |   0.0662   |   0.0655    |    0.64   
[RANK 5 GPU 1] Epoch 2 | Steps: 157
  5   |    2    |   0.0665   |   0.0655    |    0.64   
[RANK 6 GPU 2] Epoch 2 | Steps: 157
  6   |    2    |   0.0659   |   0.0655    |    0.64   
[RANK 7 GPU 3] Epoch 2 | Steps: 157
  7   |    2    |   0.0658   |   0.0655    |    0.64   
[RANK 13 GPU 1] Epoch 2 | Steps: 157
 13   |    2    |   0.0650   |   0.0655    |    0.64   
[RANK 14 GPU 2] Epoch 2 | Steps: 157
 14   |    2    |   0.0644   |   0.0655    |    0.64   
[RANK 15 GPU 3] Epoch 2 | Steps: 157
 15   |    2    |   0.0649   |   0.0655    |    0.64   
[RANK 0 GPU 0] Epoch 3 | Steps: 157
  0   |    3    |   0.0612   |   0.0618    |    0.54   
[RANK 8 GPU 0] Epoch 3 | Steps: 157
  8   |    3    |   0.0607   |   0.0618    |    0.54   
[RANK 1 GPU 1] Epoch 3 | Steps: 157
  1   |    3    |   0.0618   |   0.0618    |    0.54   
[RANK 4 GPU 0] Epoch 3 | Steps: 157
  4   |    3    |   0.0602   |   0.0618    |    0.54   
[RANK 9 GPU 1] Epoch 3 | Steps: 157
  9   |    3    |   0.0626   |   0.0618    |    0.54   
[RANK 2 GPU 2] Epoch 3 | Steps: 157
  2   |    3    |   0.0626   |   0.0618    |    0.54   
[RANK 10 GPU 2] Epoch 3 | Steps: 157
 10   |    3    |   0.0620   |   0.0618    |    0.54   
[RANK 3 GPU 3] Epoch 3 | Steps: 157
  3   |    3    |   0.0638   |   0.0618    |    0.54   
[RANK 11 GPU 3] Epoch 3 | Steps: 157
 11   |    3    |   0.0615   |   0.0618    |    0.54   
[RANK 5 GPU 1] Epoch 3 | Steps: 157
  5   |    3    |   0.0628   |   0.0618    |    0.54   
[RANK 12 GPU 0] Epoch 3 | Steps: 157
 12   |    3    |   0.0624   |   0.0618    |    0.54   
[RANK 6 GPU 2] Epoch 3 | Steps: 157
  6   |    3    |   0.0619   |   0.0618    |    0.54   
[RANK 7 GPU 3] Epoch 3 | Steps: 157
  7   |    3    |   0.0619   |   0.0618    |    0.54   
[RANK 13 GPU 1] Epoch 3 | Steps: 157
 13   |    3    |   0.0613   |   0.0618    |    0.54   
[RANK 14 GPU 2] Epoch 3 | Steps: 157
 14   |    3    |   0.0607   |   0.0618    |    0.54   
[RANK 15 GPU 3] Epoch 3 | Steps: 157
 15   |    3    |   0.0611   |   0.0618    |    0.54   
[RANK 12 GPU 0] Epoch 4 | Steps: 157
 12   |    4    |   0.0575   |   0.0570    |    0.78   
[RANK 0 GPU 0] Epoch 4 | Steps: 157
  0   |    4    |   0.0567   |   0.0570    |    0.78   
Final execution time5.2725894349999995
[RANK 0] Training done.
[RANK 4 GPU 0] Epoch 4 | Steps: 157
  4   |    4    |   0.0559   |   0.0570    |    0.78   
[RANK 13 GPU 1] Epoch 4 | Steps: 157
 13   |    4    |   0.0564   |   0.0570    |    0.78   
[RANK 1 GPU 1] Epoch 4 | Steps: 157
  1   |    4    |   0.0570   |   0.0570    |    0.78   
[RANK 8 GPU 0] Epoch 4 | Steps: 157
  8   |    4    |   0.0563   |   0.0570    |    0.78   
[RANK 14 GPU 2] Epoch 4 | Steps: 157
 14   |    4    |   0.0557   |   0.0570    |    0.78   
[RANK 2 GPU 2] Epoch 4 | Steps: 157
  2   |    4    |   0.0574   |   0.0570    |    0.78   
[RANK 9 GPU 1] Epoch 4 | Steps: 157
  9   |    4    |   0.0579   |   0.0570    |    0.78   
[RANK 15 GPU 3] Epoch 4 | Steps: 157
 15   |    4    |   0.0564   |   0.0570    |    0.78   
[RANK 3 GPU 3] Epoch 4 | Steps: 157
  3   |    4    |   0.0585   |   0.0570    |    0.78   
[RANK 10 GPU 2] Epoch 4 | Steps: 157
 10   |    4    |   0.0572   |   0.0570    |    0.78   
[RANK 11 GPU 3] Epoch 4 | Steps: 157
 11   |    4    |   0.0568   |   0.0570    |    0.78   
[RANK 5 GPU 1] Epoch 4 | Steps: 157
  5   |    4    |   0.0581   |   0.0570    |    0.78   
[RANK 6 GPU 2] Epoch 4 | Steps: 157
  6   |    4    |   0.0571   |   0.0570    |    0.78   
[RANK 7 GPU 3] Epoch 4 | Steps: 157
  7   |    4    |   0.0570   |   0.0570    |    0.78   
